# Requirements Archive: v1.0 MVP

**Archived:** 2026-02-13
**Status:** SHIPPED

---

## v1 Requirements (28 total, 27 verified, 1 human-pending)

### MCP Server Foundation

- [x] **MCP-01**: MCP server starts and accepts tool calls via Streamable HTTP transport
- [x] **MCP-02**: MCP server supports SSE fallback for backward compatibility with older clients
- [x] **MCP-03**: Server validates all tool inputs using Zod schemas before processing
- [x] **MCP-04**: Server returns structured JSON responses with consistent envelope format (valid, metadata, error)
- [x] **MCP-05**: All logging routes to stderr (stdout reserved for MCP protocol transport)

### Citation Parsing

- [x] **PARSE-01**: User can submit a citation string and receive a parsed, normalized citation object
- [x] **PARSE-02**: Parser normalizes common West Reporter format variants (e.g., "123 S. Ct 456" -> "123 S. Ct. 456", "US" -> "U.S.")
- [x] **PARSE-03**: Parser handles full-form West Reporter citations (volume + reporter + page)
- [x] **PARSE-04**: Parser rejects unparseable input with a clear error message

### Citation Verification

- [x] **VERIFY-01**: User can verify a West Reporter citation exists via `verify_west_citation` MCP tool
- [x] **VERIFY-02**: Verified citations return case name, court, date, and reporter metadata
- [x] **VERIFY-03**: Unverifiable citations return a hard "Hallucination Detected" error with details
- [x] **VERIFY-04**: Verification uses CourtListener citation-lookup API as primary source
- [x] **VERIFY-05**: Verification respects CourtListener API rate limits with request tracking

### Quote Verification

- [x] **QUOTE-01**: User can verify a quoted passage appears in a cited opinion via `verify_quote_integrity` MCP tool
- [x] **QUOTE-02**: Quote verification returns a match score (0-100%)
- [x] **QUOTE-03**: Quote verification returns the actual text from the opinion for comparison
- [x] **QUOTE-04**: Quote verification first confirms the citation exists before fetching full text
- [x] **QUOTE-05**: Quote verification uses fuzzy string matching to handle minor formatting differences

### Caching

- [x] **CACHE-01**: Verified citation results are cached to avoid redundant API calls
- [x] **CACHE-02**: Cache lookups complete in under 50ms
- [x] **CACHE-03**: Citations are immutable data -- cached results never expire (no invalidation needed)

### Configuration & Deployment

- [ ] **DEPLOY-01**: Server deploys to Vercel as a Serverless Function via `mcp-handler` -- *Code ready, human deployment verification pending*
- [x] **DEPLOY-02**: API keys (COURTLISTENER_API_KEY) are managed via environment variables
- [x] **DEPLOY-03**: Server configuration is validated at startup via Zod schema

### Error Handling

- [x] **ERR-01**: API failures (429, 5xx) are distinguished from "citation not found" in responses
- [x] **ERR-02**: Circuit breaker prevents cascading failures when CourtListener API is degraded
- [x] **ERR-03**: Rate limit exhaustion returns an explicit "rate_limited" status, not a false "not found"

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| MCP-01 | Phase 1 | Verified |
| MCP-02 | Phase 1 | Verified |
| MCP-03 | Phase 1 | Verified |
| MCP-04 | Phase 1 | Verified |
| MCP-05 | Phase 1 | Verified |
| PARSE-01 | Phase 2 | Verified |
| PARSE-02 | Phase 2 | Verified |
| PARSE-03 | Phase 2 | Verified |
| PARSE-04 | Phase 2 | Verified |
| VERIFY-01 | Phase 3 | Verified |
| VERIFY-02 | Phase 3 | Verified |
| VERIFY-03 | Phase 3 | Verified |
| VERIFY-04 | Phase 3 | Verified |
| VERIFY-05 | Phase 3 | Verified |
| QUOTE-01 | Phase 5 | Verified |
| QUOTE-02 | Phase 5 | Verified |
| QUOTE-03 | Phase 5 | Verified |
| QUOTE-04 | Phase 5 | Verified |
| QUOTE-05 | Phase 5 | Verified |
| CACHE-01 | Phase 4 | Verified |
| CACHE-02 | Phase 4 | Verified |
| CACHE-03 | Phase 4 | Verified |
| DEPLOY-01 | Phase 6 | Human pending |
| DEPLOY-02 | Phase 1 | Verified |
| DEPLOY-03 | Phase 1 | Verified |
| ERR-01 | Phase 3 | Verified |
| ERR-02 | Phase 3 | Verified |
| ERR-03 | Phase 3 | Verified |

## v2 Requirements (Deferred)

### Batch Verification
- **BATCH-01**: User can submit a block of text and get all citations verified in one call
- **BATCH-02**: Batch verification deduplicates citations before making API calls
- **BATCH-03**: Batch verification returns citation start/end positions in the source text

### Advanced Features
- **ADV-01**: Verification returns tiered confidence scores (parsed_only, existence_verified, quote_verified)
- **ADV-02**: Short-form citations (Id., supra) resolved using document context
- **ADV-03**: Parallel citation resolution (e.g., both state and regional reporter forms)
- **ADV-04**: Pre-populated cache with top 1,000 most-cited cases for instant verification

### Persistent Storage
- **STORE-01**: Verification results stored in Supabase for persistent cache across deployments
- **STORE-02**: Reporter-to-date-range mapping stored as structured data for disambiguation

## Out of Scope

| Feature | Reason |
|---------|--------|
| Good Law / KeyCite status checking | Requires paid Westlaw API access; partial coverage is worse than no coverage |
| Statute and regulation verification | Different data sources, parsing rules, and pipelines; separate MCP server |
| AI-powered citation suggestion | Turns verification tool into generative tool; recursive hallucination risk |
| Web UI / dashboard | Target user is AI agents, not humans; humans have Clearbrief/CiteCheck AI |
| Full Bluebook formatting enforcement | Hundreds of rules; separate product territory (BriefCatch) |
| Real-time document monitoring | Different architecture (persistent connection); agent's responsibility |
| CAP API integration | API shut down September 2024; CourtListener has all CAP data |
| SSE-only transport | Deprecated in MCP spec March 2025; use Streamable HTTP |

---
*Requirements defined: 2026-02-13*
*Archived: 2026-02-13 after v1.0 milestone*
